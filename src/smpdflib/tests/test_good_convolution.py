# -*- coding: utf-8 -*-
"""
Created on Fri Jan 29 10:58:48 2016

@author: Zahari Kassabov
"""
import unittest

import numpy as np

from smpdflib.core import produce_results, make_observable, PDF

class TestConstConvolution(unittest.TestCase):
    
    def test_const_results(self):
        pdf = PDF('NNPDF30_nlo_as_0118')
        obs = make_observable('data/higgs/ggh_13tev.root', order=1)
        res = produce_results(pdf, obs)[0]._data.as_matrix()
        previous = [ 31.22150023,  28.9888971 ,  31.3305855 ,  31.35700134,
        30.66074282,  28.2795592 ,  31.50932389,  31.43558106,
        31.28601552,  31.36406676,  30.69818304,  30.86453794,
        31.62708945,  31.6582997 ,  31.11008626,  31.59319744,
        31.52866286,  31.28639456,  31.07427256,  31.41568155,
        31.60044526,  31.36966168,  30.93032191,  33.05392731,
        30.96536474,  31.4317893 ,  30.72436163,  31.22605137,
        31.24243901,  31.21880536,  31.68798426,  31.07646885,
        30.59035729,  31.34800315,  31.21256586,  32.19365014,
        31.58647388,  31.74649083,  31.04692704,  30.2313781 ,
        31.4132261 ,  31.01493873,  31.36481456,  31.26872855,
        31.09018502,  31.51168931,  31.28105268,  30.91102961,
        30.88952926,  31.31389055,  31.22196011,  31.19094082,
        31.03705732,  31.54684624,  31.25938782,  31.10403155,
        30.87467055,  31.83239232,  31.05799506,  31.68930494,
        31.0387522 ,  31.27327964,  31.30919955,  31.51614659,
        31.06029472,  31.43211917,  31.35963882,  32.68355944,
        30.96018759,  30.60001451,  31.25165147,  31.37222175,
        31.19241142,  29.4805518 ,  31.66853784,  30.96975209,
        30.61955437,  31.34032813,  32.0724701 ,  30.9346566 ,
        31.27130234,  31.38000397,  30.83068422,  31.50593514,
        31.22489125,  30.74042979,  31.21191289,  31.4358684 ,
        31.27231758,  31.81871636,  31.10093208,  30.64649533,
        31.40680264,  31.12985161,  31.8378625 ,  31.18650963,
        31.51129514,  31.18025208,  31.87366192,  31.78494394,  31.45846653]
        self.assertTrue(np.allclose(res, previous))

if __name__ == '__main__':
    unittest.main()